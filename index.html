<!doctype html>
<html lang="uz">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Parol buzish vaqti tekshirgichi</title>
	<style>
		:root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;--good:#10b981;--bad:#ef4444}
		html,body{height:100%;margin:0;font-family:Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#071028 0%,#071022 100%);color:#e6eef6}
		.wrap{max-width:820px;margin:40px auto;padding:24px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
		h1{margin:0 0 8px;font-size:20px}
		p.lead{margin:0 0 18px;color:var(--muted)}
		.row{display:flex;gap:12px;flex-wrap:wrap}
		.col{flex:1;min-width:260px}
		label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
		input[type=text]{width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
		.controls{display:flex;gap:8px;margin-top:8px}
		button{background:var(--accent);border:none;color:#042024;padding:8px 10px;border-radius:8px;cursor:pointer}
		button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
		.card{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px}
		.meter{height:12px;background:rgba(255,255,255,0.04);border-radius:8px;overflow:hidden}
		.meter > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#7c3aed);width:20%}
		.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
		.muted{color:var(--muted);font-size:13px}
		.small{font-size:13px;color:var(--muted)}
		pre{white-space:pre-wrap;word-break:break-word;background:rgba(255,255,255,0.01);padding:8px;border-radius:6px}
		footer{margin-top:14px;color:var(--muted);font-size:12px}
		.danger{color:var(--bad);font-weight:600}
		a.link{color:var(--accent);text-decoration:none}
	</style>
</head>
<body>
	<div class="wrap">
		<h1>Parol buzish vaqti tekshirgichi</h1>
		<p class="lead">Parolingiz brauzer ichida hisoblanadi — hech qanday ma'lumot serverga jo'natilmaydi. Parolni yubormang yoki ommaga ko'rsatmaying.</p>

		<div class="row">
			<div class="col card">
				<label for="pwd">Parol (sinab ko'ring)</label>
				<input id="pwd" type="text" placeholder="Parolingizni kiriting" autocomplete="off" />
				<div class="controls">
					<button id="toggle">Ko'rsat</button>
					<button id="copy" class="secondary">Nusxalash</button>
					<button id="example" class="secondary">Misol: uzun passphrase</button>
				</div>

				<div style="margin-top:12px">
					<label class="small">Mustahkamlik</label>
					<div class="meter" aria-hidden><i id="meterbar"></i></div>
				</div>
			</div>

			<div class="col card">
				<label>Natija</label>
				<div class="grid">
					<div>
						<div class="small">Entropiya (bitlarda)</div>
						<div id="entropy" style="font-weight:700">—</div>
					</div>
					<div>
						<div class="small">Imkoniyatlar (approx)</div>
						<div id="combos">—</div>
					</div>
				</div>

				<hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:10px 0" />

				<div>
					<div class="small">Brute-force tezliklari va taxminiy vaqtlar</div>
					<ul id="times" style="margin:8px 0 0;padding-left:18px;color:var(--muted)"></ul>
				</div>
			</div>
		</div>

		<div style="margin-top:12px" class="card">
			<div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center">
				<div style="flex:1">
					<strong>Farazlar</strong>
					<div class="muted">Hisoblar to'liq kombinatsiyalarni sinab ko'rish (brute-force) asosida. Haqiqiy hujumlarda so'zlik hujumi, oldindan ma'lum naqshlar yoki yuborilgan parolni qayta ishlash bilan muddatlar qisqarishi mumkin.</div>
				</div>
				<div style="width:220px;text-align:right">
					<div class="small">Hech qanday ma'lumot serverga yuborilmaydi — barcha hisoblashlar faqat brauzerda</div>
				</div>
			</div>
			<hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:10px 0" />
			<div>
				<strong>Tavsiyalar</strong>
				<ul class="small muted">
					<li>Uzun passphrase (3+ so'z) yoki kamida 12+ belgidan foydalaning.</li>
					<li>Har xil belgilar to'plamini qo'llang: kichik/katta harflar, raqamlar, maxsus belgilar.</li>
					<li>Oddiy so'zlar yoki odatiy almashtirishlardan (P@ssw0rd) voz keching.</li>
				</ul>
			</div>
		</div>

		<!-- Generator section -->
		<div style="margin-top:12px" class="card" id="generator">
			<label for="genOptions"><strong>Aniqlab bo'lmaydigan parol yarating</strong></label>
			<div class="small muted">Quyidagi sozlamalarni tanlang, so'ng <em>Yaratish</em> tugmasini bosing. Parol brauzerda yaratiladi va serverga yuborilmaydi.</div>
			<div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
				<select id="preset" style="padding:8px;border-radius:8px;background:transparent;color:inherit;border:1px solid rgba(255,255,255,0.04)">
					<option value="phrase">Passphrase (so'zlardan)</option>
					<option value="random">To'liq tasodifiy (maxsus belgilar bilan)</option>
				</select>
				<input id="genLen" type="text" value="16" style="width:84px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
				<button id="generate" class="secondary">Yaratish</button>
				<button id="use" class="secondary">Parolni ishlatish</button>
				<button id="copyGen" class="secondary">Nusxalash</button>
			</div>
			<div style="margin-top:10px">
				<input id="genOut" type="text" readonly style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
				<div class="small muted" style="margin-top:6px">Maslahat: parolni saqlash uchun ishonchli parol menejeridan foydalaning.</div>
			</div>
		</div>

		<footer>
			<span class="danger">Eslatma:</span> Bu vosita faqat ma'lumot berish uchun. Parolingizni uchinchi tomonlarga yubormang.
		</footer>
	</div>

	<script>
		// No network calls. All work is local.
		const pwd = document.getElementById('pwd');
		const meter = document.getElementById('meterbar');
		const entropyEl = document.getElementById('entropy');
		const combosEl = document.getElementById('combos');
		const timesEl = document.getElementById('times');
		const toggle = document.getElementById('toggle');
		const copyBtn = document.getElementById('copy');
		const example = document.getElementById('example');

		// attacker speeds (guesses per second)
		const speeds = [
			{label:'Onlayn (1k/s)', rate:1e3},
			{label:'Tez CPU (1M/s)', rate:1e6},
			{label:'GPU cluster (1B/s)', rate:1e9},
			{label:'State-level (1T/s)', rate:1e12}
		];

		function detectCharsetSize(s){
			let set = 0;
			if(/[a-z]/.test(s)) set += 26;
			if(/[A-Z]/.test(s)) set += 26;
			if(/[0-9]/.test(s)) set += 10;
			// count common symbols
			if(/[^A-Za-z0-9\s]/.test(s)) set += 32; // rough printable punctuation
			// if only whitespace or unusually small, avoid zero
			if(set === 0 && s.length>0) set = 1;
			return set;
		}

		function log10Combos(charsetSize, length){
			// log10(charsetSize^length) = length * log10(charsetSize)
			return length * Math.log10(charsetSize);
		}

		function formatScientificFromLog10(log10Val){
			if(!isFinite(log10Val) || isNaN(log10Val)) return '—';
			if(log10Val < 3) return Math.round(Math.pow(10, log10Val)).toString();
			const exp = Math.floor(log10Val);
			const mant = Math.pow(10, log10Val - exp);
			return mant.toFixed(2) + '×10^' + exp;
		}

		function formatTimeFromLog10(log10Seconds){
			if(!isFinite(log10Seconds) || isNaN(log10Seconds)) return '—';
			if(log10Seconds < 0) return '< 1 sekund';
			const log10Minute = Math.log10(60);
			const log10Hour = Math.log10(3600);
			const log10Day = Math.log10(86400);
			const log10Year = Math.log10(31536000);

			if(log10Seconds < 3){ // show seconds
				return Math.pow(10, log10Seconds).toFixed(2) + ' s';
			}
			if(log10Seconds < log10Hour){
				const val = Math.pow(10, log10Seconds - log10Minute);
				return val.toFixed(2) + ' min';
			}
			if(log10Seconds < log10Day){
				const val = Math.pow(10, log10Seconds - log10Hour);
				return val.toFixed(2) + ' soat';
			}
			if(log10Seconds < log10Year){
				const val = Math.pow(10, log10Seconds - log10Day);
				return val.toFixed(2) + ' kun';
			}
			// years or huge
			const years = Math.pow(10, log10Seconds - log10Year);
			if(years < 1e6) return years.toFixed(2) + ' yil';
			// very large: print scientific
			const log10Years = log10Seconds - log10Year;
			const exp = Math.floor(log10Years);
			const mant = Math.pow(10, log10Years - exp);
			return mant.toFixed(2) + '×10^' + exp + ' yil';
		}

		function update(){
			const s = pwd.value || '';
			const L = s.length;
			if(L === 0){
				meter.style.width = '6%';
				entropyEl.textContent = '—';
				combosEl.textContent = '—';
				timesEl.innerHTML = '';
				return;
			}
			const charset = detectCharsetSize(s);
			const entropy = (charset>1)? (L * Math.log2(charset)) : 0;
			// combos log10
			const log10Comb = (charset>1)? log10Combos(charset,L) : 0;

			entropyEl.textContent = entropy.toFixed(2) + ' bits';
			combosEl.textContent = formatScientificFromLog10(log10Comb);

			// meter: scale entropy roughly to 128 bits
			const pct = Math.min(100, Math.round((entropy/128)*100));
			meter.style.width = Math.max(6, pct) + '%';

			// times
			timesEl.innerHTML = '';
			speeds.forEach(sp => {
				// log10(seconds) = log10(combos) - log10(rate)
				const log10Rate = Math.log10(sp.rate);
				const log10Seconds = log10Comb - log10Rate;
				const human = formatTimeFromLog10(log10Seconds);
				const li = document.createElement('li');
				li.textContent = sp.label + ': ' + human;
				timesEl.appendChild(li);
			});
		}

		pwd.addEventListener('input', update);
		toggle.addEventListener('click', ()=>{
			if(pwd.type === 'text'){ pwd.type = 'password'; toggle.textContent = 'Ko\'rsat'; }
			else { pwd.type = 'text'; toggle.textContent = "Yashir"; }
		});
		copyBtn.addEventListener('click', ()=>{
			const v = pwd.value || '';
			if(!v) return; navigator.clipboard && navigator.clipboard.writeText ? navigator.clipboard.writeText(v) : (function(){
				const ta = document.createElement('textarea'); ta.value=v; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
			})();
			copyBtn.textContent = 'Nusxalandi'; setTimeout(()=>copyBtn.textContent='Nusxalash',1200);
		});
		example.addEventListener('click', ()=>{
			pwd.value = 'yashil-qoya-toqqa-chiqish-2025'; update();
		});

		// initialize
		pwd.value = '';
		update();

		// --- Generator logic ---
		const generateBtn = document.getElementById('generate');
		const genOut = document.getElementById('genOut');
		const genLen = document.getElementById('genLen');
		const preset = document.getElementById('preset');
		const copyGen = document.getElementById('copyGen');
		const useBtn = document.getElementById('use');

		function secureRandomBytes(n){
			const arr = new Uint8Array(n);
			if(window.crypto && crypto.getRandomValues) crypto.getRandomValues(arr);
			else for(let i=0;i<n;i++) arr[i]=Math.floor(Math.random()*256);
			return arr;
		}

		function genRandomString(length){
			const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[]{};:,.<>/?~';
			const bytes = secureRandomBytes(length);
			let out = '';
			for(let i=0;i<length;i++){
				out += chars[bytes[i] % chars.length];
			}
			return out;
		}

		function genPassphrase(wordCount){
			// small internal wordlist (keeps everything local) - for stronger passphrases users should use their own words
			const words = ['!','$',')','u4','894','131','s93','*^(&)','(&**(*))','*%^^!@','@(8)','q#!@','c@#!@)','da312','ke$#','to!#@#@#h','ba323','sh232'];
			const bytes = secureRandomBytes(wordCount);
			let out = [];
			for(let i=0;i<wordCount;i++){
				out.push(words[bytes[i] % words.length]);
			}
			return out.join('-');
		}

		generateBtn.addEventListener('click', ()=>{
			let n = parseInt(genLen.value) || 16;
			if(n < 4) n = 4; if(n > 256) n = 256;
			let v = '';
			if(preset.value === 'random') v = genRandomString(n);
			else {
				// passphrase: use number as word count if < 10, else clamp
				const wc = (n <= 10) ? n : Math.min(6, Math.max(3, Math.floor(n/3)));
				v = genPassphrase(wc);
			}
			genOut.value = v;
		});

		copyGen.addEventListener('click', ()=>{
			if(!genOut.value) return;
			navigator.clipboard && navigator.clipboard.writeText ? navigator.clipboard.writeText(genOut.value) : (function(){
				const ta = document.createElement('textarea'); ta.value=genOut.value; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
			})();
			copyGen.textContent = 'Nusxalandi'; setTimeout(()=>copyGen.textContent='Nusxalash',1200);
		});

		useBtn.addEventListener('click', ()=>{
			if(!genOut.value) return;
			pwd.value = genOut.value;
			update();
		});
	</script>
</body>
</html>

